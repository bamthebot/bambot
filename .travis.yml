dist: xenial
language: python
env:
  global:
  - ENVIRONMENT=test
  - BOT_NICKNAME="bamthebot"
  - COMMAND_PREFIX="!"
  - BANGS_ENDPOINT="http://ubuntu@ec2-13-58-112-69.us-east-2.compute.amazonaws.com/bot/api/bangs/"
  - USERS_ENDPOINT="http://ubuntu@ec2-13-58-112-69.us-east-2.compute.amazonaws.com/bot/api/twitch_users/"
  - BANGS_TOKEN="TODO"
  - USERS_TOKEN="TODO"
  - TWITCH_URI="wss://irc-ws.chat.twitch.tv:443"
  - BOTMASTER_RUN="yes"
services:
- docker
before_install:
- docker build -t bambot .
script:
- docker-compose -f docker-compose.test.yaml up
deploy:
- provider: script
  script: bash scripts/deploy.sh master
  on:
    branch: master
- provider: script
  script: bash scripts/deploy.sh stage
  on:
    branch: stage
